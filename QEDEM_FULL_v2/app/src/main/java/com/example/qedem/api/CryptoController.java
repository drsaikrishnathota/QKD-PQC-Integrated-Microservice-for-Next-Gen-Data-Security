package com.example.qedem.api; import com.example.qedem.service.CryptoService; import com.example.qedem.util.Bytes; import org.springframework.web.bind.annotation.*; @RestController @RequestMapping("/api/crypto") public class CryptoController{ private final CryptoService svc; public CryptoController(CryptoService s){this.svc=s;} static class Req{ public String keyBase64; public String plaintext; public String ivBase64; public String ciphertextBase64; public String tagBase64; } static class Resp{ public String ivBase64; public String ciphertextBase64; public String tagBase64; } @PostMapping("/encrypt") public Resp enc(@RequestBody Req r){ var out=svc.enc(Bytes.deb64(r.keyBase64), r.plaintext); var o=new Resp(); o.ivBase64=out.iv(); o.ciphertextBase64=out.ct(); o.tagBase64=out.tag(); return o; } @PostMapping("/decrypt") public String dec(@RequestBody Req r){ return svc.dec(Bytes.deb64(r.keyBase64), r.ivBase64, r.ciphertextBase64, r.tagBase64); } }
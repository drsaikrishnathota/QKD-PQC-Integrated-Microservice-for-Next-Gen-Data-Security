package com.example.qedem.crypto; import javax.crypto.*; import javax.crypto.spec.*; import java.util.*; import java.security.*; public class AesGcm{ public record Enc(byte[] iv, byte[] ct, byte[] tag){} public static Enc encrypt(byte[] key, byte[] pt){ try{ byte[] iv=new byte[12]; new SecureRandom().nextBytes(iv); Cipher c=Cipher.getInstance("AES/GCM/NoPadding"); c.init(Cipher.ENCRYPT_MODE,new SecretKeySpec(key,"AES"),new GCMParameterSpec(128,iv)); byte[] out=c.doFinal(pt); int tl=16; return new Enc(iv, Arrays.copyOf(out,out.length-tl), Arrays.copyOfRange(out,out.length-tl,out.length)); }catch(Exception e){ throw new RuntimeException(e);} } public static byte[] decrypt(byte[] key, byte[] iv, byte[] ct, byte[] tag){ try{ Cipher c=Cipher.getInstance("AES/GCM/NoPadding"); byte[] in=new byte[ct.length+tag.length]; System.arraycopy(ct,0,in,0,ct.length); System.arraycopy(tag,0,in,ct.length,tag.length); c.init(Cipher.DECRYPT_MODE,new GCMParameterSpec(128,iv),new SecretKeySpec(key,"AES")); return c.doFinal(in);}catch(Exception e){throw new RuntimeException(e);} } }
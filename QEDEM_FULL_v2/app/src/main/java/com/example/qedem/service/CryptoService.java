package com.example.qedem.service; import com.example.qedem.crypto.AesGcm; import com.example.qedem.util.Bytes; import org.springframework.stereotype.Service; @Service public class CryptoService{ public record EncOut(String iv,String ct,String tag){} public EncOut enc(byte[] key,String pt){ var e=AesGcm.encrypt(key, pt.getBytes()); return new EncOut(Bytes.b64(e.iv()),Bytes.b64(e.ct()),Bytes.b64(e.tag())); } public String dec(byte[] key,String iv,String ct,String tag){ return new String(AesGcm.decrypt(key,Bytes.deb64(iv),Bytes.deb64(ct),Bytes.deb64(tag))); } }